# Gitflow実践入門ガイド
☑️実践完了日：2025/8/8
<br>
---
このガイドでは、チームでの開発でよく使われるブランチ管理手法「Gitflow」（ギットフロー）の基本的な考え方と、実際にブランチを作成して作業する流れを学びます。

## 1. Gitflowって何？ なぜ使うの？

Gitflowは、Gitのブランチを効果的に使って、複数人での開発や本番環境の運用をスムーズにするための「ルールの集まり」です。決まった役割のブランチを使い分けることで、以下のようなメリットがあります。

*   **安全な開発:** 本番環境で動いている安定したコード（`main`ブランチ）と、開発中のコード（`develop`ブランチ）を明確に分けるので、開発中のバグが本番に影響するのを防ぎます。
*   **並行作業がしやすい:** 新機能の開発、バグ修正、リリース準備などを、それぞれ専用のブランチで同時に進めることができます。
*   **歴史が分かりやすい:** ブランチの役割が決まっているので、後から見返したときに「いつ、誰が、何のために」作業したのかが追いやすくなります。

## 2. Gitflowの主要なブランチたち

Gitflowでは、主に以下の5種類のブランチを使います。常に存在するのは`main`と`develop`の2つです。

| ブランチの種類 | 役割 | 説明 |
| :--- | :--- | :--- |
| `main` | **本番用ブランチ** | 実際にユーザーが使っている製品のコード。ここに直接コミットすることはありません。 |
| `develop` | **開発用ブランチ** | 次にリリースする予定の機能がすべて統合される、開発の中心となるブランチ。 |
| `feature` | **機能開発ブランチ** | 新しい機能を追加するために作るブランチ。`develop`から分岐し、完成したら`develop`に合流します。 |
| `release` | **リリース準備ブランチ** | `develop`から分岐し、リリース前の最終調整（バグ修正など）を行うブランチ。完了したら`main`と`develop`に合流します。 |
| `hotfix` | **緊急バグ修正ブランチ** | 本番環境（`main`）で発生した緊急のバグを修正するためのブランチ。`main`から分岐し、修正が完了したら`main`と`develop`に合流します。 |

## 3. ブランチを切る練習をしてみよう！ (featureブランチの作成)

それでは、実際に新しい機能（例: ユーザープロフィールページ）を追加する場面を想定して、`feature`ブランチを作成してみましょう。

**ステップ 1: `develop`ブランチを作成して移動する**

まだ`develop`ブランチがない場合は、まず`main`ブランチから作成します。Gitflowでは、`develop`が開発の起点になります。

```bash
# 現在のブランチがmainであることを確認
git branch

# developブランチを作成して、そのブランチに移動する
git switch -c develop
git switch develop
```

**ステップ 2: `feature`ブランチを作成する**

次に、`develop`ブランチから新しい機能のための`feature`ブランチを作成します。ブランチ名は `feature/機能名` のように、分かりやすい名前をつけましょう。

```bash
# developブランチにいることを確認
git branch

# 'feature/add-user-profile' という名前のブランチを作成して移動する
git switch -c feature/add-user-profile
git switch feature/add-user-profile
```

これで、`feature/add-user-profile`という新しいブランチが作成され、あなたはそのブランチ上で作業を始める準備ができました！

**ステップ 3: (シミュレーション) ファイルを編集してコミットする**

このブランチで、新しい機能に関するコードを追加・編集します。ここでは、練習として`src/app/profile/page.tsx`というファイルを作成してみましょう。

```bash
# ディレクトリを作成
mkdir -p src/app/profile

# 新しいファイルを作成
touch src/app/profile/page.tsx

# ファイルに内容を書き込む（実際にはエディタで編集します）
echo "export default function ProfilePage() { return <h1>プロフィールページ</h1>; }" > src/app/profile/page.tsx
```

変更内容をコミットします。

```bash
# 変更をステージング
git add .

# コミット
git commit -m "feat: Add user profile page"
git commit -m "feat: Add new design page"
```

**ステップ 4: `develop`ブランチに合流（マージ）する**

機能が完成したら、`develop`ブランチに移動して、作成した`feature`ブランチの内容を取り込み（マージし）ます。

```bash
# developブランチに移動
git switch develop

# feature/add-user-profile ブランチの内容をdevelopブランチにマージ
git merge feature/add-user-profile
```

**ステップ 5: 不要になった`feature`ブランチを削除する**

`develop`ブランチに無事マージされたら、`feature/add-user-profile`ブランチは不要になるので削除します。

```bash
git branch -d feature/add-user-profile
```

これで、Gitflowの基本的な機能開発の流れは完了です！

## 4. まとめ

1.  開発を始めるときは、まず`develop`ブランチに移動する。
2.  新しい機能を作るときは、`develop`から`feature`ブランチを作成する。
3.  機能が完成したら、`develop`ブランチにマージする。
4.  マージが完了したら、`feature`ブランチは削除する。

この流れを繰り返すことで、安全かつ効率的に開発を進めることができます。ぜひ、このガイドを見ながら実際に手を動かして、Gitflowに慣れていきましょう。

## 5. Gitflowをぐちゃぐちゃにしないためのポイント

Gitflowを運用する上で、履歴が複雑になったり、ブランチが散らかったりするのを防ぐためのポイントをいくつか紹介します。

### コミットのタイミングと粒度

*   **小さく、頻繁にコミットする:** 一つの機能や修正を完成させるまでに、複数のコミットに分けましょう。例えば、「A機能のUI実装」「A機能のロジック実装」「A機能のテストコード追加」のように、意味のある単位でコミットします。これにより、後から変更内容を追いやすくなり、問題が発生した際の原因特定も容易になります。
*   **コミットメッセージを丁寧に書く:** 「何を変更したか」だけでなく、「なぜ変更したか」も簡潔に記述しましょう。チームメンバーや未来の自分がコードを理解する上で非常に役立ちます。

### featureブランチを消すタイミング

*   **マージ後すぐに削除する:** `feature`ブランチは、`develop`ブランチにマージされたらすぐに削除しましょう。残しておくと、どのブランチが作業中なのか分かりにくくなり、ブランチが乱立する原因になります。`git branch -d <branch-name>` コマンドで削除できます。

### ぐちゃぐちゃにならないためのその他のポイント

*   **Pull Request (PR) / Code Reviewの活用:** チーム開発では、`feature`ブランチを`develop`にマージする前に、Pull Requestを作成し、他のメンバーにコードレビューをしてもらいましょう。これにより、コード品質の向上、バグの早期発見、知識共有が促進されます。
*   **`rebase`の慎重な利用:** `rebase`はコミット履歴をきれいに保つ強力なツールですが、既に共有されているブランチ（特に`develop`や`main`）に対して`rebase`を行うと、他のメンバーの履歴と衝突し、混乱を招く可能性があります。基本的には、自分のローカルブランチでのみ使用し、共有ブランチへのマージは`merge`（特に`--no-ff`オプションを推奨）を使用するのが安全です。
*   **定期的なブランチの整理:** 定期的にリモートリポジトリのブランチを確認し、不要なブランチが残っていないか確認・削除しましょう。これにより、ブランチリストが常に整理された状態を保てます。

これらのポイントを意識することで、Gitflowのメリットを最大限に活かし、チーム開発をよりスムーズに進めることができます。

### リモートリポジトリへのプッシュ

ローカルで作成・変更したブランチは、そのままではGitHubやVercelなどのリモートサービスには反映されません。変更を共有したり、Vercelでデプロイをトリガーしたりするには、明示的にリモートリポジトリにプッシュする必要があります。

特に新しいブランチを初めてプッシュする際は、以下のコマンドを使用します。

```bash
git push -u origin <ブランチ名>
```

*   `-u` または `--set-upstream` オプションは、ローカルブランチとリモートブランチの追跡関係を設定します。これにより、次回以降は単に `git push` と入力するだけで、このブランチの変更をプッシュできるようになります。
*   `origin` は通常、リモートリポジトリのデフォルト名です。
*   `<ブランチ名>` は、プッシュしたいブランチの名前（例: `develop`, `feature/add-user-profile`）に置き換えてください。

**例: `develop`ブランチを初めてプッシュする場合**

```bash
git push -u origin develop
git push -u origin feature/add-user-profile
```

このコマンドを実行することで、ローカルの`develop`ブランチがリモートの`origin/develop`として作成され、以降の変更がリモートに反映されるようになります。VercelなどのCI/CDサービスは、リモートリポジトリへのプッシュを検知して自動デプロイを行うため、このステップが非常に重要。

### `origin`って何？

`origin` は Git における**リモートリポジトリのデフォルト名**です。

Gitでは、あなたのローカルにあるリポジトリ（今作業している場所）と、GitHubやGitLab、Bitbucketなどのオンライン上にあるリポジトリ（リモートリポジトリ）を連携させて使います。

*   **リモートリポジトリ:** チームメンバーとコードを共有したり、Vercelのようなサービスがコードを取得してデプロイしたりする場所です。
*   **ローカルリポジトリ:** あなたのPC上にある、コードのコピーです。

通常、`git clone` コマンドでリポジトリをクローンすると、そのクローン元のリモートリポジトリに自動的に `origin` という名前が付けられます。これは単なる慣習的な名前であり、`upstream` や `my-remote` など、好きな名前に変更することも可能です。

つまり、`git push origin develop` というコマンドは、「`develop` ブランチの変更を、`origin` という名前のリモートリポジトリにプッシュする」という意味になります。

2025/8/8完了